<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>R-TYPE: RFC: UDP Protocol for Multiplayer Game Communication</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">R-TYPE<span id="projectnumber">&#160;0.1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">RFC: UDP Protocol for Multiplayer Game Communication </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md51"></a>
Table of Contents</h1>
<ul>
<li>1. Introduction</li>
<li>2. Objectives</li>
<li>3. Package Structure</li>
<li>4. UDP Command<ul>
<li>4.1 Command Descriptions<ul>
<li>4.1.1 NEW_ENTITY_STATIC</li>
<li>4.1.2 NEW_ENTITY_PLAYER</li>
<li>4.1.3 NEW_ENTITY_MISSILE</li>
<li>4.1.4 NEW_ENTITY_MISSILE_BALL</li>
<li>4.1.5 NEW_ENTITY_BYDOS_WAVE</li>
<li>4.1.6 NEW_ENTITY_ROBOT_GROUND</li>
<li>4.1.7 NEW_ENTITY_DOBKERATOPS</li>
<li>4.1.8 NEW_ENTITY_DOBKERATOPS_PART</li>
<li>4.1.9 NEW_ENTITY_BOSS_PARASITE</li>
<li>4.1.10 NEW_ENTITY_BLOB</li>
<li>4.1.11 TAKE_DAMAGE</li>
<li>4.1.12 MOVE_ENTITY</li>
<li>4.1.13 CHANGE_ANIMATION_STATE</li>
<li>4.1.14 DEL_ENTITY</li>
<li>4.1.15 PING</li>
<li>4.1.16 END_GAME</li>
</ul>
</li>
</ul>
</li>
<li>5. Package Integrity</li>
<li>6. Packet Loss Management</li>
<li>7. Usage Scenarios<ul>
<li>7.1 Creating a Player Entity</li>
<li>7.2 Updating an Entities Position</li>
<li>7.3 Deleting an Entity</li>
</ul>
</li>
<li>8. Error handling</li>
<li>9. Conclusion</li>
</ul>
<h1><a class="anchor" id="autotoc_md52"></a>
1. Introduction</h1>
<p>This RFC describes the UDP protocol for real-time communications in a multiplayer game. The protocol is optimized for an environment where speed and low latency are crucial. UDP is chosen for its simplicity and low overhead, allowing for rapid transmission of game data between clients and the server, even at the expense of strict reliability.</p>
<h1><a class="anchor" id="autotoc_md53"></a>
2. Objectives</h1>
<p>The main objectives of the protocol are:</p>
<ul>
<li>To provide a fast, low-latency communication channel between clients and the server.</li>
<li>To efficiently synchronize the states of game entities among multiple clients.</li>
<li>To manage real-time events such as movements, creation, and deletion of entities.</li>
<li>To tolerate packet loss without causing critical malfunctions in the game.</li>
</ul>
<h1><a class="anchor" id="autotoc_md54"></a>
3. Package structure</h1>
<p>The UDP packets used in this protocol follow a fixed structure in the header, with a variable body depending on the type of command.</p>
<h2><a class="anchor" id="autotoc_md55"></a>
3.1 En-tÃªte des paquets</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Size   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>magic</code>   </td><td class="markdownTableBodyNone">8 bytes   </td><td class="markdownTableBodyNone">Magic value to validate the integrity of the packet.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>size</code>   </td><td class="markdownTableBodyNone">8 bytes   </td><td class="markdownTableBodyNone">Total size of the packet, including the header and body.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>cmd</code>   </td><td class="markdownTableBodyNone">1 byte   </td><td class="markdownTableBodyNone">Specifies the type of command (see section 4).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>sharedEntityId</code>   </td><td class="markdownTableBodyNone">4 bytes   </td><td class="markdownTableBodyNone">Unique identifier of the entity or client associated with the message.   </td></tr>
</table>
<p>This header is essential for identifying the nature of the packet, the size of the transported data, and the specific command associated with it.</p>
<h2><a class="anchor" id="autotoc_md56"></a>
3.2 Packet Body</h2>
<p>The packet body contains data specific to the command defined in the <code>cmd</code> field. The structure of the data in the body varies depending on the type of command and can include information about game entities, such as their positions, velocities, or other attributes.</p>
<h1><a class="anchor" id="autotoc_md57"></a>
4. UDP Command (&lt;tt&gt;UDPCommand&lt;/tt&gt;)</h1>
<p>Packets contain a <code>cmd</code> field that specifies the command being sent. The available command types in the UDP protocol for this game are listed below:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NONE</code>   </td><td class="markdownTableBodyNone">0x00   </td><td class="markdownTableBodyNone">No operation, empty command, or placeholder.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_STATIC</code>   </td><td class="markdownTableBodyNone">0x01   </td><td class="markdownTableBodyNone">Create a new static entity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_PLAYER</code>   </td><td class="markdownTableBodyNone">0x02   </td><td class="markdownTableBodyNone">Create a new player entity.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_MISSILE</code>   </td><td class="markdownTableBodyNone">0x03   </td><td class="markdownTableBodyNone">Create a missile entity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_MISSILE_BALL</code>   </td><td class="markdownTableBodyNone">0x04   </td><td class="markdownTableBodyNone">Create a missile entity in the form of a ball.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_BYDOS_WAVE</code>   </td><td class="markdownTableBodyNone">0x05   </td><td class="markdownTableBodyNone">Create a Bydos wave entity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NEW_ENTITY_ROBOT_GROUND</code>   </td><td class="markdownTableBodyNone">0x06   </td><td class="markdownTableBodyNone">Create a ground robot entity.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>MOVE_ENTITY</code>   </td><td class="markdownTableBodyNone">0x07   </td><td class="markdownTableBodyNone">Update an entity's position and velocity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>DEL_ENTITY</code>   </td><td class="markdownTableBodyNone">0x0A   </td><td class="markdownTableBodyNone">Delete an existing entity.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>TAKE_DAMAGE</code>   </td><td class="markdownTableBodyNone">0x0B   </td><td class="markdownTableBodyNone">Apply damage to an entity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CHANGE_ANIMATION_STATE</code>   </td><td class="markdownTableBodyNone">0x0C   </td><td class="markdownTableBodyNone">Change the animation state of an entity.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>PING</code>   </td><td class="markdownTableBodyNone">0x0D   </td><td class="markdownTableBodyNone">Send a ping message to check the connection status.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>END_GAME</code>   </td><td class="markdownTableBodyNone">0x0E   </td><td class="markdownTableBodyNone">End the game and indicate if the player has won.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md58"></a>
4.1 Command Descriptions</h2>
<h3><a class="anchor" id="autotoc_md59"></a>
4.1.1 &lt;tt&gt;NEW_ENTITY_PLAYER&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 1</li>
<li><b>Description</b>: Creates a new static entity without movement, with the specified initial position.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the static entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_STATIC {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">};</div>
<div class="ttc" id="astructecs_1_1component_1_1Position_html"><div class="ttname"><a href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a></div><div class="ttdoc">Represents a position component for an entity.</div><div class="ttdef"><b>Definition:</b> position.hpp:18</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md60"></a>
4.1.2 &lt;tt&gt;NEW_ENTITY_PLAYER&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 2</li>
<li><b>Description</b>: Creates a player entity with a unique identifier, player name, and movement data.</li>
<li><b>Data</b>:<ul>
<li><code>playerId</code>: Unique identifier for the player.</li>
<li><code>playerIndex</code>: Index for the player.</li>
<li><code>playerName</code>: Name of the player.</li>
<li><code>moveData</code>: Movement data of the entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_PLAYER {</div>
<div class="line">    std::size_t playerId;</div>
<div class="line">    std::size_t playerIndex;</div>
<div class="line">    <span class="keywordtype">char</span> playerName[MAX_USER_NAME_SIZE + 1];</div>
<div class="line">    MOVE_ENTITY moveData;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md61"></a>
4.1.3 &lt;tt&gt;NEW_ENTITY_MISSILE&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 3</li>
<li><b>Description</b>: Creates a missile entity with position and velocity data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the missile.</li>
<li><code>vel</code>: Velocity of the missile.</li>
<li><code>chargeLevel</code>: The charge level of the missile.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_MISSILE {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">    <a class="code hl_struct" href="../../d1/d4c/structecs_1_1component_1_1Velocity.html">ecs::component::Velocity</a> vel{};</div>
<div class="line">    <span class="keywordtype">int</span> chargeLevel = 0;</div>
<div class="line">};</div>
<div class="ttc" id="astructecs_1_1component_1_1Velocity_html"><div class="ttname"><a href="../../d1/d4c/structecs_1_1component_1_1Velocity.html">ecs::component::Velocity</a></div><div class="ttdoc">Represents a velocity component for an entity.</div><div class="ttdef"><b>Definition:</b> velocity.hpp:18</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md62"></a>
4.1.4 &lt;tt&gt;NEW_ENTITY_MISSILE_BALL&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 4</li>
<li><b>Description</b>: Creates a missile entity in the shape of a ball with position and velocity data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the missile ball.</li>
<li><code>vel</code>: Velocity of the missile ball.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_MISSILE_BALL {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">    <a class="code hl_struct" href="../../d1/d4c/structecs_1_1component_1_1Velocity.html">ecs::component::Velocity</a> vel{};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md63"></a>
4.1.5 &lt;tt&gt;NEW_ENTITY_BYDOS_WAVE&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 5</li>
<li><b>Description</b>: Creates a new Bydos wave entity with position data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the Bydos wave.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_BYDOS_WAVE {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md64"></a>
4.1.6 &lt;tt&gt;NEW_ENTITY_ROBOT_GROUND&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 6</li>
<li><b>Description</b>: Creates a new ground robot entity with position and movement data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the ground robot.</li>
<li><code>vel</code>: Velocity of the ground robot.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_ROBOT_GROUND {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">    <a class="code hl_struct" href="../../d1/d4c/structecs_1_1component_1_1Velocity.html">ecs::component::Velocity</a> vel{};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md65"></a>
4.1.7 &lt;tt&gt;NEW_ENTITY_DOBKERATOPS&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 7</li>
<li><b>Description</b>: Creates a new <a class="el" href="../../d3/da1/structDobkeratops.html" title="Represents the state and behavior of the Dobkeratops boss.">Dobkeratops</a> entity with position data and an initial stage.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the <a class="el" href="../../d3/da1/structDobkeratops.html" title="Represents the state and behavior of the Dobkeratops boss.">Dobkeratops</a> entity.</li>
<li><code>stage</code>: Indicates the level of development or difficulty of the entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_DOBKERATOPS {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">    <span class="keywordtype">int</span> stage = 1;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md66"></a>
4.1.8 &lt;tt&gt;NEW_ENTITY_DOBKERATOPS_PART&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 8</li>
<li><b>Description</b>: Creates a new part of the <a class="el" href="../../d3/da1/structDobkeratops.html" title="Represents the state and behavior of the Dobkeratops boss.">Dobkeratops</a> entity with position data and a part index.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the <a class="el" href="../../d3/da1/structDobkeratops.html" title="Represents the state and behavior of the Dobkeratops boss.">Dobkeratops</a> part.</li>
<li><code>partIndex</code>: Indicates the specific index of the part.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_DOBKERATOPS_PART {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">    <span class="keywordtype">int</span> partIndex = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md67"></a>
4.1.9 &lt;tt&gt;NEW_ENTITY_BOSS_PARASITE&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 9</li>
<li><b>Description</b>: Creates a new Boss Parasite entity with position data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the Boss Parasite entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_BOSS_PARASITE {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md68"></a>
4.1.10 &lt;tt&gt;NEW_ENTITY_BLOB&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 10</li>
<li><b>Description</b>: Creates a new Blob entity with position data.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the Blob entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>NEW_ENTITY_BLOB {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos{};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md69"></a>
4.1.11 &lt;tt&gt;TAKE_DAMAGE&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 11</li>
<li><b>Description</b>: Applies damage to an entity.</li>
<li><b>Data</b>:<ul>
<li><code>damage</code>: The amount of damage to apply.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>TAKE_DAMAGE {</div>
<div class="line">    <span class="keywordtype">int</span> damage = 1;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md70"></a>
4.1.12 &lt;tt&gt;MOVE_ENTITY&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 7</li>
<li><b>Description</b>: Updates the position and velocity of an existing entity.</li>
<li><b>Data</b>:<ul>
<li><code>pos</code>: Position of the entity.</li>
<li><code>vel</code>: Velocity of the entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>MOVE_ENTITY {</div>
<div class="line">    <a class="code hl_struct" href="../../db/d8f/structecs_1_1component_1_1Position.html">ecs::component::Position</a> pos;</div>
<div class="line">    <a class="code hl_struct" href="../../d1/d4c/structecs_1_1component_1_1Velocity.html">ecs::component::Velocity</a> vel;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md71"></a>
4.1.13 &lt;tt&gt;CHANGE_ANIMATION_STATE&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 13</li>
<li><b>Description</b>: Changes the animation state of an entity.</li>
<li><b>Data</b>:<ul>
<li><code>newState</code>: The new animation state to set for the entity.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>CHANGE_ANIMATION_STATE {</div>
<div class="line">    <span class="keywordtype">char</span> newState[32] = {0};</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md72"></a>
4.1.14 &lt;tt&gt;DEL_ENTITY&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 10</li>
<li><b>Description</b>: Deletes a specific entity from the game.</li>
<li><b>Data</b>:<ul>
<li><code>sharedEntityId</code>: Unique ID of the entity to delete.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>DEL_ENTITY {</div>
<div class="line">    <a class="code hl_typedef" href="../../df/dc5/shared__entity_8hpp.html#a0cc2c6dd78eb754a763a3ae66802fd56">shared_entity_t</a> sharedEntityId; <span class="comment">// Unique ID of the entity to delete</span></div>
<div class="line">};</div>
<div class="ttc" id="ashared__entity_8hpp_html_a0cc2c6dd78eb754a763a3ae66802fd56"><div class="ttname"><a href="../../df/dc5/shared__entity_8hpp.html#a0cc2c6dd78eb754a763a3ae66802fd56">shared_entity_t</a></div><div class="ttdeci">std::size_t shared_entity_t</div><div class="ttdoc">Alias for the shared entity identifier type.</div><div class="ttdef"><b>Definition:</b> shared_entity.hpp:18</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md73"></a>
4.1.15 &lt;tt&gt;PING&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 15</li>
<li><b>Description</b>: Sends a ping message to check the connection status.</li>
<li><b>Data</b>:<ul>
<li><code>sendTime</code>: The time the ping was sent, typically used for latency measurement.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>PING {</div>
<div class="line">    <span class="keywordtype">long</span> sendTime = 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md74"></a>
4.1.16 &lt;tt&gt;END_GAME&lt;/tt&gt;</h3>
<ul>
<li><b>Command ID</b>: 16</li>
<li><b>Description</b>: Ends the game and indicates whether the player has won or lost.</li>
<li><b>Data</b>:<ul>
<li><code>win</code>: A boolean value indicating if the player won the game.</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">struct </span>END_GAME {</div>
<div class="line">    <span class="keywordtype">bool</span> win = <span class="keyword">false</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md75"></a>
5. Package Integrity</h2>
<p>All UDP packets can be verified via a crc32 field that must be calculated from the packet's header and body. This allows for the detection of potential errors in data transmission.</p>
<h2><a class="anchor" id="autotoc_md76"></a>
6. Packet Loss Management</h2>
<p>Since UDP does not guarantee packet delivery, the protocol implements mechanisms that are tolerant to data loss. Entity updates are periodically retransmitted, allowing clients to correct their local state in case of packet loss.</p>
<h2><a class="anchor" id="autotoc_md77"></a>
7. Usage Scenarios</h2>
<h3><a class="anchor" id="autotoc_md78"></a>
7.1 Creating a Player Entity</h3>
<p>The server sends a packet with the NEW_ENTITY_PLAYER command to create a new player entity. The client receives the packet and updates its game state with the new entity.</p>
<h3><a class="anchor" id="autotoc_md79"></a>
7.2 Updating an Entities Position</h3>
<p>A MOVE_ENTITY packet is sent to update the position and velocity of an entity. The receiving client or server applies the new coordinates and velocity to the affected entity.</p>
<h3><a class="anchor" id="autotoc_md80"></a>
7.3 Deleting an Entity</h3>
<p>The server sends a DEL_ENTITY command to indicate that an entity has been removed from the game. The client receives the packet and removes the corresponding entity from its game state.</p>
<h2><a class="anchor" id="autotoc_md81"></a>
8. Error Handling</h2>
<p>In the event of receiving an invalid packet (e.g., wrong magic number or size), the protocol must log the error and discard the packet. Additionally, the system should be able to handle exceptions when processing packets without crashing the game.</p>
<p>Example Error Handling</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (header-&gt;magic != rt::UDP_MAGIC) {</div>
<div class="line">    <a class="code hl_function" href="../../d5/d87/namespaceeng.html#ac95e1dcef5dafb5bda9e0b4e87021b27">eng::logWarning</a>(<span class="stringliteral">&quot;Invalid UDP magic received !&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>; <span class="comment">// Ignore the packet</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (header-&gt;size &gt; size) {</div>
<div class="line">    <a class="code hl_function" href="../../d5/d87/namespaceeng.html#ac95e1dcef5dafb5bda9e0b4e87021b27">eng::logWarning</a>(<span class="stringliteral">&quot;Packet of invalid size received !&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>; <span class="comment">// Ignore the packet</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespaceeng_html_ac95e1dcef5dafb5bda9e0b4e87021b27"><div class="ttname"><a href="../../d5/d87/namespaceeng.html#ac95e1dcef5dafb5bda9e0b4e87021b27">eng::logWarning</a></div><div class="ttdeci">void logWarning(const std::string &amp;msg, std::source_location info=std::source_location::current())</div><div class="ttdoc">Logs a warning message with source location.</div><div class="ttdef"><b>Definition:</b> Logger.cpp:68</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md82"></a>
9. Conclusion</h2>
<p>This UDP protocol for multiplayer games provides an efficient, low-latency solution for synchronizing game states between multiple clients and a central server. It allows for great flexibility in managing game entities while tolerating packet loss. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
